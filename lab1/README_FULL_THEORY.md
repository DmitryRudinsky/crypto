# üìò –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ1 - –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
## –ü–û–õ–ù–û–ï –¢–ï–û–†–ï–¢–ò–ß–ï–°–ö–û–ï –†–£–ö–û–í–û–î–°–¢–í–û –î–õ–Ø –ó–ê–©–ò–¢–´

---

# üìë –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–í–≤–µ–¥–µ–Ω–∏–µ –≤ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—É—é –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—é](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–ó–∞–¥–∞–Ω–∏–µ 1: –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏—Ç–æ–≤](#–∑–∞–¥–∞–Ω–∏–µ-1-–ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞-–±–∏—Ç–æ–≤)
3. [–ó–∞–¥–∞–Ω–∏–µ 2: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∑–∞–¥–∞–Ω–∏–µ-2-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)
4. [–ó–∞–¥–∞–Ω–∏–µ 3: –°–µ—Ç—å –§–µ–π—Å—Ç–µ–ª—è](#–∑–∞–¥–∞–Ω–∏–µ-3-—Å–µ—Ç—å-—Ñ–µ–π—Å—Ç–µ–ª—è)
5. [–ó–∞–¥–∞–Ω–∏–µ 4: –ê–ª–≥–æ—Ä–∏—Ç–º DES](#–∑–∞–¥–∞–Ω–∏–µ-4-des)
6. [–ó–∞–¥–∞–Ω–∏–µ 5: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤](#–∑–∞–¥–∞–Ω–∏–µ-5-—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ-—Ñ–∞–π–ª–æ–≤)
7. [–ó–∞–¥–∞–Ω–∏–µ 6: –ê–ª–≥–æ—Ä–∏—Ç–º DEAL](#–∑–∞–¥–∞–Ω–∏–µ-6-deal)
8. [–ó–∞–¥–∞–Ω–∏–µ 7: DEAL –¥–ª—è —Ñ–∞–π–ª–æ–≤](#–∑–∞–¥–∞–Ω–∏–µ-7-deal-–¥–ª—è-—Ñ–∞–π–ª–æ–≤)
9. [–†–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è](#—Ä–µ–∂–∏–º—ã-—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è)
10. [–†–µ–∂–∏–º—ã –Ω–∞–±–∏–≤–∫–∏](#—Ä–µ–∂–∏–º—ã-–Ω–∞–±–∏–≤–∫–∏)
11. [–ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#–ø–∞—Ç—Ç–µ—Ä–Ω—ã-–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
12. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

# –í–í–ï–î–ï–ù–ò–ï –í –°–ò–ú–ú–ï–¢–†–ò–ß–ù–£–Æ –ö–†–ò–ü–¢–û–ì–†–ê–§–ò–Æ

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è

### –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
**–°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** - –º–µ—Ç–æ–¥ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á**.

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- **–°–∫–æ—Ä–æ—Å—Ç—å**: –±—ã—Å—Ç—Ä–µ–µ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –≤ 100-1000 —Ä–∞–∑
- **–ö–ª—é—á**: —Å–µ–∫—Ä–µ—Ç–Ω—ã–π, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑–≤–µ—Å—Ç–µ–Ω –æ–±–µ–∏–º —Å—Ç–æ—Ä–æ–Ω–∞–º
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–æ–±–ª–µ–º–∞**: –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –∫–ª—é—á–∞ –º–µ–∂–¥—É —Å—Ç–æ—Ä–æ–Ω–∞–º–∏

### –ë–ª–æ—á–Ω—ã–µ —à–∏—Ñ—Ä—ã

**–ë–ª–æ—á–Ω—ã–π —à–∏—Ñ—Ä** - –∞–ª–≥–æ—Ä–∏—Ç–º —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∞–º–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–∞:
- **–†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞** (n): –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç –≤ –æ–¥–Ω–æ–º –±–ª–æ–∫–µ (–æ–±—ã—á–Ω–æ 64, 128, 256)
- **–†–∞–∑–º–µ—Ä –∫–ª—é—á–∞** (k): –¥–ª–∏–Ω–∞ –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤** (r): —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞

#### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å:
```
E_K: {0,1}^n ‚Üí {0,1}^n  (—Ñ—É–Ω–∫—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è)
D_K: {0,1}^n ‚Üí {0,1}^n  (—Ñ—É–Ω–∫—Ü–∏—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è)

–≥–¥–µ D_K(E_K(M)) = M –¥–ª—è –ª—é–±–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è M
```

---

# –ó–ê–î–ê–ù–ò–ï 1: –ü–ï–†–ï–°–¢–ê–ù–û–í–ö–ê –ë–ò–¢–û–í

## –¢–µ–æ—Ä–∏—è

### –ß—Ç–æ —Ç–∞–∫–æ–µ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ (permutation)?

**–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞** - –±–∏–µ–∫—Ç–∏–≤–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –Ω–∞ —Å–µ–±—è. –í –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞ –±–∏—Ç–æ–≤ –≤ –±–ª–æ–∫–µ –¥–∞–Ω–Ω—ã—Ö.

#### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:
```
P: {0,1,...,n-1} ‚Üí {0,1,...,n-1}
–≥–¥–µ P - –±–∏–µ–∫—Ü–∏—è (–≤–∑–∞–∏–º–Ω–æ-–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–µ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏–µ)
```

### P-–±–ª–æ–∫ (Permutation box)

**P-–±–ª–æ–∫** - –º–∞—Å—Å–∏–≤ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –Ω–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –±–∏—Ç–æ–≤.

#### –ü—Ä–∏–º–µ—Ä:
```
–í—Ö–æ–¥–Ω—ã–µ –±–∏—Ç—ã:  B‚ÇÄ B‚ÇÅ B‚ÇÇ B‚ÇÉ B‚ÇÑ B‚ÇÖ B‚ÇÜ B‚Çá
P-–±–ª–æ–∫:        [7, 6, 5, 4, 3, 2, 1, 0]
–í—ã—Ö–æ–¥–Ω—ã–µ –±–∏—Ç—ã: B‚Çá B‚ÇÜ B‚ÇÖ B‚ÇÑ B‚ÇÉ B‚ÇÇ B‚ÇÅ B‚ÇÄ  (—Ä–µ–≤–µ—Ä—Å)
```

### –†–µ–∂–∏–º—ã –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏

#### 1. NORMAL (–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å 0)
–ë–∏—Ç—ã –Ω—É–º–µ—Ä—É—é—Ç—Å—è –æ—Ç 0: `[0, 1, 2, 3, 4, 5, 6, 7]`

#### 2. INVERTED (–∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è)
–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã —Å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏, –≥–¥–µ –±–∏—Ç—ã —á–∞—Å—Ç–æ –Ω—É–º–µ—Ä—É—é—Ç—Å—è —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ.

### –ê–ª–≥–æ—Ä–∏—Ç–º –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏

#### –ü—Å–µ–≤–¥–æ–∫–æ–¥:
```
function permuteBits(input: byte[], pBlock: int[], mode: BitIndexMode):
    1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç: totalBits = input.length * 8
    2. –°–æ–∑–¥–∞—Ç—å –≤—ã—Ö–æ–¥–Ω–æ–π –º–∞—Å—Å–∏–≤ —Ç–∞–∫–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞
    3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ i –≤ pBlock:
        a. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å —Å —É—á–µ—Ç–æ–º mode
        b. –ò–∑–≤–ª–µ—á—å –±–∏—Ç –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ pBlock[i] –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        c. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏—Ç –≤ –ø–æ–∑–∏—Ü–∏—é i –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    4. –í–µ—Ä–Ω—É—Ç—å –≤—ã—Ö–æ–¥–Ω–æ–π –º–∞—Å—Å–∏–≤
```

#### –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∏—Ç–∞–º–∏:

**–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –±–∏—Ç–∞:**
```java
int getBit(byte[] data, int position):
    int byteIndex = position / 8
    int bitIndex = position % 8
    return (data[byteIndex] >> (7 - bitIndex)) & 1
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏—Ç–∞:**
```java
void setBit(byte[] data, int position, int value):
    int byteIndex = position / 8
    int bitIndex = position % 8
    if (value == 1):
        data[byteIndex] |= (1 << (7 - bitIndex))
    else:
        data[byteIndex] &= ~(1 << (7 - bitIndex))
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏

–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤:
1. **DES** - –Ω–∞—á–∞–ª—å–Ω–∞—è (IP) –∏ –∫–æ–Ω–µ—á–Ω–∞—è (IP‚Åª¬π) –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏
2. **AES** - –æ–ø–µ—Ä–∞—Ü–∏—è ShiftRows
3. **P-–±–ª–æ–∫–∏** –≤ —Å–µ—Ç—è—Ö –§–µ–π—Å—Ç–µ–ª—è

### –°–≤–æ–π—Å—Ç–≤–∞ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫

1. **–û–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å**: –¥–ª—è –ª—é–±–æ–π –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ P —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –æ–±—Ä–∞—Ç–Ω–∞—è P‚Åª¬π
2. **–ö–æ–º–ø–æ–∑–∏—Ü–∏—è**: –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ = –æ–¥–Ω–∞ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞
3. **–î–∏—Ñ—Ñ—É–∑–∏—è**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –≤—Ö–æ–¥–Ω–æ–≥–æ –±–∏—Ç–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö


---

# –ó–ê–î–ê–ù–ò–ï 2: –ò–ù–¢–ï–†–§–ï–ô–°–´ –ò –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

## –¢–µ–æ—Ä–∏—è –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–Ω—Ü–∏–ø—ã SOLID

#### 1. Single Responsibility Principle (SRP)
–ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –æ–¥–Ω—É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- `KeySchedule` - —Ç–æ–ª—å–∫–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–ª—é—á–∞
- `RoundFunction` - —Ç–æ–ª—å–∫–æ —Ä–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏—è
- `SymmetricCipher` - —Ç–æ–ª—å–∫–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

#### 2. Open/Closed Principle (OCP)
–ö–ª–∞—Å—Å—ã –æ—Ç–∫—Ä—ã—Ç—ã –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, –Ω–æ –∑–∞–∫—Ä—ã—Ç—ã –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –ù–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- –ù–µ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å `CipherContext` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞

#### 3. Liskov Substitution Principle (LSP)
–û–±—ä–µ–∫—Ç—ã –ø–æ–¥–∫–ª–∞—Å—Å–∞ –¥–æ–ª–∂–Ω—ã –∑–∞–º–µ–Ω—è—Ç—å –æ–±—ä–µ–∫—Ç—ã —Å—É–ø–µ—Ä–∫–ª–∞—Å—Å–∞.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –õ—é–±–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `SymmetricCipher` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `CipherContext`
- DES –∏ DEAL –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã

#### 4. Interface Segregation Principle (ISP)
–ö–ª–∏–µ–Ω—Ç—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –¢—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ
- –ú–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

#### 5. Dependency Inversion Principle (DIP)
–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π, –∞ –Ω–µ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- `CipherContext` –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `SymmetricCipher`, –∞ –Ω–µ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞

## –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å KeySchedule

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è) –≥–ª–∞–≤–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤ –Ω–∞–±–æ—Ä —Ä–∞—É–Ω–¥–æ–≤—ã—Ö –∫–ª—é—á–µ–π.

### –¢–µ–æ—Ä–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∫–ª—é—á–∞

**–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–ª—é—á–∞** (Key Schedule) - –ø—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞—É–Ω–¥–æ–≤—ã—Ö –∫–ª—é—á–µ–π –∏–∑ –æ–¥–Ω–æ–≥–æ –≥–ª–∞–≤–Ω–æ–≥–æ –∫–ª—é—á–∞.

#### –ó–∞—á–µ–º –Ω—É–∂–Ω–æ?
1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –∫–ª—é—á–µ–π –≤ –∫–∞–∂–¥–æ–º —Ä–∞—É–Ω–¥–µ
2. **–î–∏—Ñ—Ñ—É–∑–∏—è**: —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≤–ª–∏—è–Ω–∏—è –∫–ª—é—á–∞ –Ω–∞ –≤–µ—Å—å —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç
3. **–ö–æ–Ω—Ñ—É–∑–∏—è**: —É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–ª—é—á–æ–º –∏ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–æ–º

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å

```
KS: {0,1}^k √ó ‚Ñï ‚Üí {0,1}^k_r

–≥–¥–µ:
- k - –¥–ª–∏–Ω–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –∫–ª—é—á–∞
- k_r - –¥–ª–∏–Ω–∞ —Ä–∞—É–Ω–¥–æ–≤–æ–≥–æ –∫–ª—é—á–∞
- ‚Ñï - –Ω–æ–º–µ—Ä —Ä–∞—É–Ω–¥–∞
```

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–æ–≤

```java
public interface KeySchedule {
    /**
     * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≥–ª–∞–≤–Ω—ã–π –∫–ª—é—á –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–∞—É–Ω–¥–æ–≤—ã–µ –∫–ª—é—á–∏
     * @param key –≥–ª–∞–≤–Ω—ã–π –∫–ª—é—á
     */
    void setKey(byte[] key);
    
    /**
     * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞—É–Ω–¥–æ–≤—ã–π –∫–ª—é—á –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ä–∞—É–Ω–¥–∞
     * @param round –Ω–æ–º–µ—Ä —Ä–∞—É–Ω–¥–∞ (–Ω–∞—á–∏–Ω–∞—è —Å 0)
     * @return —Ä–∞—É–Ω–¥–æ–≤—ã–π –∫–ª—é—á
     */
    byte[] getRoundKey(int round);
    
    /**
     * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤
     * @return –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤
     */
    int getRounds();
}
```

### –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π

#### 1. –ü—Ä–æ—Å—Ç–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (SimpleKeySchedule)
```
K‚ÇÄ = K
K‚ÇÅ = K ‚äï 1
K‚ÇÇ = K ‚äï 2
...
K_r = K ‚äï r
```

#### 2. DES Key Schedule (PC1, PC2, —Å–¥–≤–∏–≥–∏)
–°–ª–æ–∂–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –∏ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–º–∏ —Å–¥–≤–∏–≥–∞–º–∏.

#### 3. DEAL Key Schedule
–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ 192-–±–∏—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ —Ç—Ä–∏ 64-–±–∏—Ç–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–∞ –¥–ª—è DES.

## –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å RoundFunction

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–∏–º–µ–Ω—è–µ–º–æ–π –∫ –¥–∞–Ω–Ω—ã–º –≤ –∫–∞–∂–¥–æ–º —Ä–∞—É–Ω–¥–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.

### –¢–µ–æ—Ä–∏—è —Ä–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏–∏

**–†–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏—è** F - –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ –±–ª–æ—á–Ω–æ–º —à–∏—Ñ—Ä–µ.

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ F:
1. **–ö–æ–Ω—Ñ—É–∑–∏—è** (confusion): —Å–ª–æ–∂–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞ –æ—Ç –∫–ª—é—á–∞
2. **–î–∏—Ñ—Ñ—É–∑–∏—è** (diffusion): –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –±–∏—Ç–∞ –≤—Ö–æ–¥–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ –º–Ω–æ–≥–∏–µ –±–∏—Ç—ã –≤—ã—Ö–æ–¥–∞
3. **–ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å**: –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–∏–Ω–µ–π–Ω–æ–≥–æ –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑–∞

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å

```
F: {0,1}^n √ó {0,1}^k ‚Üí {0,1}^n

–≥–¥–µ:
- n - —Ä–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞
- k - —Ä–∞–∑–º–µ—Ä –∫–ª—é—á–∞ —Ä–∞—É–Ω–¥–∞
```

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–æ–≤

```java
public interface RoundFunction {
    /**
     * –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ä–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏—é –∫ –±–ª–æ–∫—É –¥–∞–Ω–Ω—ã—Ö
     * @param data –≤—Ö–æ–¥–Ω–æ–π –±–ª–æ–∫
     * @param roundKey –∫–ª—é—á —Ä–∞—É–Ω–¥–∞
     * @return —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏
     */
    byte[] apply(byte[] data, byte[] roundKey);
    
    /**
     * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞ –≤ –±–∞–π—Ç–∞—Ö
     * @return —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞
     */
    int getBlockSize();
}
```

### –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π

#### 1. –ü—Ä–æ—Å—Ç–∞—è —Ä–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏—è (SimpleRoundFunction)
```
F(R, K) = (R <<< 1) ‚äï K
```
–≥–¥–µ `<<<` - —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥ –≤–ª–µ–≤–æ

#### 2. DES Round Function
–°–ª–æ–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º E, S-–±–ª–æ–∫–∞–º–∏ –∏ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–æ–π P:
```
F(R, K) = P(S-boxes(E(R) ‚äï K))
```

#### 3. DES Adapter (–¥–ª—è DEAL)
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ DES –∫–∞–∫ —Ä–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏—é:
```
F(R, K) = DES_encrypt(R, K)
```

## –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å SymmetricCipher

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ª—é–±–æ–≥–æ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.

### –¢–µ–æ—Ä–∏—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö —à–∏—Ñ—Ä–æ–≤

**–°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π —à–∏—Ñ—Ä** - –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –æ–¥–∏–Ω –∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.

#### –¢–∏–ø—ã:
1. **–ü–æ—Ç–æ–∫–æ–≤—ã–µ** (stream ciphers): —à–∏—Ñ—Ä—É—é—Ç –ø–æ –æ–¥–Ω–æ–º—É –±–∏—Ç—É/–±–∞–π—Ç—É
2. **–ë–ª–æ—á–Ω—ã–µ** (block ciphers): —à–∏—Ñ—Ä—É—é—Ç –±–ª–æ–∫–∞–º–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å

```
E_K: M ‚Üí C  (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)
D_K: C ‚Üí M  (–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)

–≥–¥–µ:
- M - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
- C - –º–Ω–æ–∂–µ—Å—Ç–≤–æ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–æ–≤
- K - –∫–ª—é—á
- D_K(E_K(m)) = m –¥–ª—è –ª—é–±–æ–≥–æ m ‚àà M
```

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–æ–≤

```java
public interface SymmetricCipher {
    /**
     * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
     * @param key –∫–ª—é—á
     */
    void setEncryptionKey(byte[] key);
    
    /**
     * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–ª—é—á –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
     * @param key –∫–ª—é—á
     */
    void setDecryptionKey(byte[] key);
    
    /**
     * –®–∏—Ñ—Ä—É–µ—Ç –æ–¥–∏–Ω –±–ª–æ–∫ –¥–∞–Ω–Ω—ã—Ö
     * @param plaintext –æ—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç (—Ä–∞–∑–º–µ—Ä = blockSize)
     * @return —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç
     */
    byte[] encryptBlock(byte[] plaintext);
    
    /**
     * –î–µ—à–∏—Ñ—Ä—É–µ—Ç –æ–¥–∏–Ω –±–ª–æ–∫ –¥–∞–Ω–Ω—ã—Ö
     * @param ciphertext —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç (—Ä–∞–∑–º–µ—Ä = blockSize)
     * @return –æ—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç
     */
    byte[] decryptBlock(byte[] ciphertext);
    
    /**
     * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ –≤ –±–∞–π—Ç–∞—Ö
     * @return —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞
     */
    int getBlockSize();
    
    /**
     * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∫–ª—é—á–∞ –≤ –±–∞–π—Ç–∞—Ö
     * @return —Ä–∞–∑–º–µ—Ä –∫–ª—é—á–∞
     */
    int getKeySize();
}
```

## –ö–ª–∞—Å—Å CipherContext

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∂–∏–º–∞–º–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –Ω–∞–±–∏–≤–∫–æ–π –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CipherContext
‚îú‚îÄ‚îÄ cipher: SymmetricCipher    (–∫–æ–º–ø–æ–∑–∏—Ü–∏—è)
‚îú‚îÄ‚îÄ mode: CipherMode           (—Å—Ç—Ä–∞—Ç–µ–≥–∏—è)
‚îú‚îÄ‚îÄ padding: PaddingMode       (—Å—Ç—Ä–∞—Ç–µ–≥–∏—è)
‚îî‚îÄ‚îÄ executorService            (–ø—É–ª –ø–æ—Ç–æ–∫–æ–≤)
```

### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

```java
public CipherContext(
    SymmetricCipher cipher,  // –ê–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
    byte[] key,              // –ö–ª—é—á
    CipherMode mode,         // –†–µ–∂–∏–º (ECB, CBC, etc.)
    PaddingMode padding,     // –ù–∞–±–∏–≤–∫–∞ (PKCS7, etc.)
    int blockSize,           // –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞
    byte[]... iv             // IV (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
)
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

#### –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
```java
public byte[] encrypt(byte[] plaintext)
```

#### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
```java
public CompletableFuture<Void> encryptAsync(
    byte[] plaintext,
    byte[][] result
)
```

#### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
```java
public CompletableFuture<Void> encryptFileAsync(
    String inputPath,
    String outputPath
)
```

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏–µ

#### Java CompletableFuture
```java
ExecutorService executor = Executors.newFixedThreadPool(
    Runtime.getRuntime().availableProcessors()
);

CompletableFuture.supplyAsync(() -> {
    // –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
    return encrypt(data);
}, executor);
```

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
1. **–ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –∂–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
2. **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**: –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–ª–æ–∫–æ–≤ —à–∏—Ñ—Ä—É—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–¥–ª—è ECB, CTR)
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —è–¥–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞


---

# –ó–ê–î–ê–ù–ò–ï 3: –°–ï–¢–¨ –§–ï–ô–°–¢–ï–õ–Ø

## –¢–µ–æ—Ä–∏—è —Å–µ—Ç–∏ –§–µ–π—Å—Ç–µ–ª—è

### –ò—Å—Ç–æ—Ä–∏—è
**–°–µ—Ç—å –§–µ–π—Å—Ç–µ–ª—è** (Feistel Network) - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–∞, –∏–∑–æ–±—Ä–µ—Ç–µ–Ω–Ω–∞—è –•–æ—Ä—Å—Ç–æ–º –§–µ–π—Å—Ç–µ–ª–µ–º –≤ IBM –≤ –Ω–∞—á–∞–ª–µ 1970-—Ö –≥–æ–¥–æ–≤.

### –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

–ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: **—Ä–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏—è F –Ω–µ –æ–±—è–∑–∞–Ω–∞ –±—ã—Ç—å –æ–±—Ä–∞—Ç–∏–º–æ–π**, –Ω–æ –≤–µ—Å—å —à–∏—Ñ—Ä –æ—Å—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–∏–º—ã–º.

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å

#### –û–¥–∏–Ω —Ä–∞—É–Ω–¥ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:
```
–í—Ö–æ–¥: (L‚ÇÄ, R‚ÇÄ) - –¥–≤–µ –ø–æ–ª–æ–≤–∏–Ω—ã –±–ª–æ–∫–∞
–†–∞—É–Ω–¥-–∫–ª—é—á: K_i

L_{i+1} = R_i
R_{i+1} = L_i ‚äï F(R_i, K_i)

–í—ã—Ö–æ–¥: (L_{i+1}, R_{i+1})
```

#### –û–¥–∏–Ω —Ä–∞—É–Ω–¥ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:
```
–í—Ö–æ–¥: (L_{i+1}, R_{i+1})
–†–∞—É–Ω–¥-–∫–ª—é—á: K_i (—Ç–æ—Ç –∂–µ —Å–∞–º—ã–π!)

R_i = L_{i+1}
L_i = R_{i+1} ‚äï F(L_{i+1}, K_i)

–í—ã—Ö–æ–¥: (L_i, R_i)
```

### –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç–∏

```
–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: R_{i+1} = L_i ‚äï F(R_i, K_i)
–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: L_i = R_{i+1} ‚äï F(L_{i+1}, K_i)

–ü–æ–¥—Å—Ç–∞–≤–∏–º L_{i+1} = R_i:
L_i = R_{i+1} ‚äï F(R_i, K_i)
L_i = (L_i ‚äï F(R_i, K_i)) ‚äï F(R_i, K_i)
L_i = L_i ‚äï (F(R_i, K_i) ‚äï F(R_i, K_i))
L_i = L_i ‚äï 0
L_i = L_i  ‚úì
```

### –ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

```
–û—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç (64 –±–∏—Ç–∞)
        ‚Üì
    –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ L‚ÇÄ –∏ R‚ÇÄ (–ø–æ 32 –±–∏—Ç–∞)
        ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  –†–∞—É–Ω–¥ 1        ‚îÇ  L‚ÇÅ = R‚ÇÄ
    ‚îÇ  F(R‚ÇÄ, K‚ÇÅ)      ‚îÇ  R‚ÇÅ = L‚ÇÄ ‚äï F(R‚ÇÄ, K‚ÇÅ)
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  –†–∞—É–Ω–¥ 2        ‚îÇ  L‚ÇÇ = R‚ÇÅ
    ‚îÇ  F(R‚ÇÅ, K‚ÇÇ)      ‚îÇ  R‚ÇÇ = L‚ÇÅ ‚äï F(R‚ÇÅ, K‚ÇÇ)
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
       ...
        ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  –†–∞—É–Ω–¥ r        ‚îÇ  L_r = R_{r-1}
    ‚îÇ  F(R_{r-1}, K_r)‚îÇ  R_r = L_{r-1} ‚äï F(R_{r-1}, K_r)
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
    –û–±–º–µ–Ω –ø–æ–ª–æ–≤–∏–Ω: (R_r, L_r)
        ‚Üì
    –®–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç (64 –±–∏—Ç–∞)
```

### –°–≤–æ–π—Å—Ç–≤–∞ —Å–µ—Ç–∏ –§–µ–π—Å—Ç–µ–ª—è

#### 1. –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –†–∞–∑–ª–∏—á–∏–µ —Ç–æ–ª—å–∫–æ –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π (–æ–±—Ä–∞—Ç–Ω—ã–π)

#### 2. –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å
- –î–∞–∂–µ –µ—Å–ª–∏ F –Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞, –≤–µ—Å—å —à–∏—Ñ—Ä –æ–±—Ä–∞—Ç–∏–º
- F –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π

#### 3. –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ù–µ –Ω—É–∂–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è F‚Åª¬π
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–æ–¥ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

#### 4. –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∂–∏–º—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞—É–Ω–¥–æ–≤

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ç–∏ –§–µ–π—Å—Ç–µ–ª—è

#### –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞
- **DES**: 64 –±–∏—Ç–∞ (32+32)
- **DEAL**: 128 –±–∏—Ç (64+64)
- **Blowfish**: 64 –±–∏—Ç–∞
- **Twofish**: 128 –±–∏—Ç

#### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤
- **DES**: 16 —Ä–∞—É–Ω–¥–æ–≤
- **DEAL**: 6 —Ä–∞—É–Ω–¥–æ–≤
- **Blowfish**: 16 —Ä–∞—É–Ω–¥–æ–≤
- **Twofish**: 16 —Ä–∞—É–Ω–¥–æ–≤

–ë–æ–ª—å—à–µ —Ä–∞—É–Ω–¥–æ–≤ = –≤—ã—à–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –Ω–æ –Ω–∏–∂–µ —Å–∫–æ—Ä–æ—Å—Ç—å.

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ Java

```java
public class FeistelCipher implements SymmetricCipher {
    private RoundFunction roundFunction;
    private KeySchedule keySchedule;
    private int rounds;
    
    public byte[] encryptBlock(byte[] plaintext) {
        // 1. –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ L –∏ R
        byte[] L = Arrays.copyOfRange(plaintext, 0, blockSize/2);
        byte[] R = Arrays.copyOfRange(plaintext, blockSize/2, blockSize);
        
        // 2. –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞—É–Ω–¥—ã
        for (int i = 0; i < rounds; i++) {
            byte[] newL = R.clone();
            byte[] f = roundFunction.apply(R, keySchedule.getRoundKey(i));
            byte[] newR = xor(L, f);
            
            L = newL;
            R = newR;
        }
        
        // 3. –û–±–º–µ–Ω—è—Ç—å –ø–æ–ª–æ–≤–∏–Ω—ã –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å
        return concatenate(R, L);
    }
}
```

### –ü—Ä–∏–º–µ—Ä—ã –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –Ω–∞ –±–∞–∑–µ –§–µ–π—Å—Ç–µ–ª—è

1. **DES** (Data Encryption Standard)
2. **3DES** (Triple DES)
3. **DEAL** (Data Encryption Algorithm with Larger blocks)
4. **Blowfish**
5. **Twofish**
6. **Camellia**
7. **–ì–û–°–¢ 28147-89** (—Ä–æ—Å—Å–∏–π—Å–∫–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç)

---

# –ó–ê–î–ê–ù–ò–ï 4: –ê–õ–ì–û–†–ò–¢–ú DES

## –ò—Å—Ç–æ—Ä–∏—è DES

### –°–æ–∑–¥–∞–Ω–∏–µ
- **1970-1972**: IBM —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª–∞ –∞–ª–≥–æ—Ä–∏—Ç–º Lucifer (–•–æ—Ä—Å—Ç –§–µ–π—Å—Ç–µ–ª—å)
- **1973**: NBS (National Bureau of Standards, –Ω—ã–Ω–µ NIST) –æ–±—ä—è–≤–∏–ª–æ –∫–æ–Ω–∫—É—Ä—Å
- **1974**: IBM –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∞ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Lucifer
- **1977**: DES –ø—Ä–∏–Ω—è—Ç –∫–∞–∫ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –°–®–ê (FIPS 46)
- **2001**: DES –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ AES

### –ö—Ä–∏—Ç–∏–∫–∞ –∏ —Å–ø–æ—Ä—ã
- **–†–∞–∑–º–µ—Ä –∫–ª—é—á–∞**: 56 –±–∏—Ç —Å—á–∏—Ç–∞–ª—Å—è —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–º –¥–∞–∂–µ –≤ 1970-—Ö
- **S-–±–ª–æ–∫–∏**: –ø–æ–¥–æ–∑—Ä–µ–Ω–∏—è –æ –Ω–∞–ª–∏—á–∏–∏ –∑–∞–∫–ª–∞–¥–æ–∫ (–æ–ø—Ä–æ–≤–µ—Ä–≥–Ω—É—Ç—ã –≤ 1990-—Ö)
- **NSA**: —É—á–∞—Å—Ç–∏–µ NSA –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –≤—ã–∑—ã–≤–∞–ª–æ –≤–æ–ø—Ä–æ—Å—ã

### –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- **–£—Å—Ç–∞—Ä–µ–ª**: –≤–∑–ª–æ–º–∞–Ω –º–µ—Ç–æ–¥–æ–º –ø–µ—Ä–µ–±–æ—Ä–∞ –∑–∞ 22 —á–∞—Å–∞ (1999)
- **–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –¥–ª—è –∑–∞—â–∏—Ç—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å**: –æ—Ç–ª–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ DES

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ | 64 –±–∏—Ç–∞ (8 –±–∞–π—Ç) |
| –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞ | 56 –±–∏—Ç (+ 8 –±–∏—Ç —á–µ—Ç–Ω–æ—Å—Ç–∏ = 64 –±–∏—Ç–∞) |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤ | 16 |
| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ | –°–µ—Ç—å –§–µ–π—Å—Ç–µ–ª—è |
| –†–∞–∑–º–µ—Ä S-–±–ª–æ–∫–æ–≤ | 8 —à—Ç—É–∫, 6‚Üí4 –±–∏—Ç–∞ –∫–∞–∂–¥—ã–π |

### –û–±—â–∞—è —Å—Ö–µ–º–∞ DES

```
–û—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç (64 –±–∏—Ç–∞)
        ‚Üì
    IP (Initial Permutation)
        ‚Üì
    –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ L‚ÇÄ –∏ R‚ÇÄ
        ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  16 —Ä–∞—É–Ω–¥–æ–≤ –§–µ–π—Å—Ç–µ–ª—è    ‚îÇ
    ‚îÇ  F(R, K) = P(S(E(R)‚äïK)) ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
    –û–±–º–µ–Ω –ø–æ–ª–æ–≤–∏–Ω
        ‚Üì
    IP‚Åª¬π (Final Permutation)
        ‚Üì
    –®–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç (64 –±–∏—Ç–∞)
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã DES

### 1. –ù–∞—á–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ (IP)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ø–µ—Ä–µ–º–µ—à–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –±–∏—Ç—ã –¥–ª—è –ª—É—á—à–µ–π –¥–∏—Ñ—Ñ—É–∑–∏–∏.

```
IP = [58, 50, 42, 34, 26, 18, 10, 2,
      60, 52, 44, 36, 28, 20, 12, 4,
      62, 54, 46, 38, 30, 22, 14, 6,
      64, 56, 48, 40, 32, 24, 16, 8,
      57, 49, 41, 33, 25, 17,  9, 1,
      59, 51, 43, 35, 27, 19, 11, 3,
      61, 53, 45, 37, 29, 21, 13, 5,
      63, 55, 47, 39, 31, 23, 15, 7]
```

–ë–∏—Ç 58 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–∏—Ç–æ–º 1, –±–∏—Ç 50 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–∏—Ç–æ–º 2, –∏ —Ç.–¥.

### 2. –†–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏—è F

**–°–∞–º–∞—è –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å DES!**

```
F(R, K) = P(S(E(R) ‚äï K))

–≥–¥–µ:
- E - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ 32‚Üí48 –±–∏—Ç
- ‚äï - XOR —Å —Ä–∞—É–Ω–¥–æ–≤—ã–º –∫–ª—é—á–æ–º (48 –±–∏—Ç)
- S - –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ S-–±–ª–æ–∫–∏ 48‚Üí32 –±–∏—Ç–∞
- P - –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ 32 –±–∏—Ç–∞
```

#### –®–∞–≥ 1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ E (Expansion)

–†–∞—Å—à–∏—Ä—è–µ—Ç 32-–±–∏—Ç–Ω—ã–π –±–ª–æ–∫ R –¥–æ 48 –±–∏—Ç –ø—É—Ç–µ–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±–∏—Ç–æ–≤.

```
E = [32,  1,  2,  3,  4,  5,
      4,  5,  6,  7,  8,  9,
      8,  9, 10, 11, 12, 13,
     12, 13, 14, 15, 16, 17,
     16, 17, 18, 19, 20, 21,
     20, 21, 22, 23, 24, 25,
     24, 25, 26, 27, 28, 29,
     28, 29, 30, 31, 32,  1]
```

**–ó–∞—á–µ–º?**
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–º–µ—Ä—É –∫–ª—é—á–∞ (48 –±–∏—Ç)
- –î–∏—Ñ—Ñ—É–∑–∏—è: –æ–¥–∏–Ω –±–∏—Ç –≤–ª–∏—è–µ—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ S-–±–ª–æ–∫–æ–≤

#### –®–∞–≥ 2: XOR —Å –∫–ª—é—á–æ–º

```
result = E(R) ‚äï K_i
```

–ü—Ä–æ—Å—Ç–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è, –Ω–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

#### –®–∞–≥ 3: S-–±–ª–æ–∫–∏ (Substitution boxes)

**–°–∞–º–∞—è –Ω–µ–ª–∏–Ω–µ–π–Ω–∞—è —á–∞—Å—Ç—å DES!**

8 S-–±–ª–æ–∫–æ–≤, –∫–∞–∂–¥—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç 6 –±–∏—Ç ‚Üí 4 –±–∏—Ç–∞.

##### –†–∞–±–æ—Ç–∞ S-–±–ª–æ–∫–∞:

```
–í—Ö–æ–¥: 6 –±–∏—Ç = b‚ÇÅb‚ÇÇb‚ÇÉb‚ÇÑb‚ÇÖb‚ÇÜ

–°—Ç—Ä–æ–∫–∞: r = b‚ÇÅb‚ÇÜ (–±–∏—Ç—ã 1 –∏ 6) - 2 –±–∏—Ç–∞ (0-3)
–°—Ç–æ–ª–±–µ—Ü: c = b‚ÇÇb‚ÇÉb‚ÇÑb‚ÇÖ (–±–∏—Ç—ã 2-5) - 4 –±–∏—Ç–∞ (0-15)

–í—ã—Ö–æ–¥: S[r][c] - 4 –±–∏—Ç–∞
```

##### –ü—Ä–∏–º–µ—Ä S1:

```
S1 = [
  [14,  4, 13,  1,  2, 15, 11,  8,  3, 10,  6, 12,  5,  9,  0,  7],
  [ 0, 15,  7,  4, 14,  2, 13,  1, 10,  6, 12, 11,  9,  5,  3,  8],
  [ 4,  1, 14,  8, 13,  6,  2, 11, 15, 12,  9,  7,  3, 10,  5,  0],
  [15, 12,  8,  2,  4,  9,  1,  7,  5, 11,  3, 14, 10,  0,  6, 13]
]
```

**–°–≤–æ–π—Å—Ç–≤–∞ S-–±–ª–æ–∫–æ–≤:**
1. **–ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å**: –≥–ª–∞–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–∏–Ω–µ–π–Ω–æ–≥–æ –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑–∞
2. **–õ–∞–≤–∏–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ 1 –≤—Ö–æ–¥–Ω–æ–≥–æ –±–∏—Ç–∞ –º–µ–Ω—è–µ—Ç ~2 –≤—ã—Ö–æ–¥–Ω—ã—Ö –±–∏—Ç–∞
3. **–ë–∏–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –Ω–µ—Ç (6‚Üí4), –Ω–æ –≤–∞–∂–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å

#### –®–∞–≥ 4: –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ P

–§–∏–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã—Ö–æ–¥–∞ S-–±–ª–æ–∫–æ–≤.

```
P = [16,  7, 20, 21, 29, 12, 28, 17,
      1, 15, 23, 26,  5, 18, 31, 10,
      2,  8, 24, 14, 32, 27,  3,  9,
     19, 13, 30,  6, 22, 11,  4, 25]
```

**–¶–µ–ª—å**: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Ñ—Ñ—É–∑–∏—è - –∫–∞–∂–¥—ã–π –±–∏—Ç S-–±–ª–æ–∫–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–∑–Ω—ã–µ –ø–æ–ª–æ–≤–∏–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞—É–Ω–¥–µ.

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–ª—é—á–∞ DES

#### –ü—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–∞—É–Ω–¥–æ–≤—ã—Ö –∫–ª—é—á–µ–π:

```
–ì–ª–∞–≤–Ω—ã–π –∫–ª—é—á (64 –±–∏—Ç–∞, –∏–∑ –Ω–∏—Ö 8 –±–∏—Ç —á–µ—Ç–Ω–æ—Å—Ç–∏)
        ‚Üì
    PC-1 (Permuted Choice 1) - –≤—ã–±–æ—Ä 56 –±–∏—Ç
        ‚Üì
    –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ C‚ÇÄ –∏ D‚ÇÄ (–ø–æ 28 –±–∏—Ç)
        ‚Üì
    –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞—É–Ω–¥–∞ i:
        1. –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥ C –∏ D –≤–ª–µ–≤–æ
        2. PC-2 (Permuted Choice 2) - –≤—ã–±–æ—Ä 48 –±–∏—Ç
        3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å K_i
```

#### PC-1: Permuted Choice 1

–í—ã–±–∏—Ä–∞–µ—Ç 56 –±–∏—Ç –∏–∑ 64, –æ—Ç–±—Ä–∞—Å—ã–≤–∞—è –±–∏—Ç—ã —á–µ—Ç–Ω–æ—Å—Ç–∏ (–∫–∞–∂–¥—ã–π 8-–π).

```
PC1 = [57, 49, 41, 33, 25, 17,  9,
        1, 58, 50, 42, 34, 26, 18,
       10,  2, 59, 51, 43, 35, 27,
       19, 11,  3, 60, 52, 44, 36,
       63, 55, 47, 39, 31, 23, 15,
        7, 62, 54, 46, 38, 30, 22,
       14,  6, 61, 53, 45, 37, 29,
       21, 13,  5, 28, 20, 12,  4]
```

#### –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å–¥–≤–∏–≥–∏

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞—É–Ω–¥–∞ C –∏ D —Å–¥–≤–∏–≥–∞—é—Ç—Å—è –≤–ª–µ–≤–æ –Ω–∞ 1 –∏–ª–∏ 2 –±–∏—Ç–∞:

```
–†–∞—É–Ω–¥—ã —Å 1 —Å–¥–≤–∏–≥–æ–º: 1, 2, 9, 16
–†–∞—É–Ω–¥—ã —Å 2 —Å–¥–≤–∏–≥–∞–º–∏: 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15
```

#### PC-2: Permuted Choice 2

–í—ã–±–∏—Ä–∞–µ—Ç 48 –±–∏—Ç –∏–∑ 56 –¥–ª—è —Ä–∞—É–Ω–¥–æ–≤–æ–≥–æ –∫–ª—é—á–∞.

```
PC2 = [14, 17, 11, 24,  1,  5,
        3, 28, 15,  6, 21, 10,
       23, 19, 12,  4, 26,  8,
       16,  7, 27, 20, 13,  2,
       41, 52, 31, 37, 47, 55,
       30, 40, 51, 45, 33, 48,
       44, 49, 39, 56, 34, 53,
       46, 42, 50, 36, 29, 32]
```

### 4. –ö–æ–Ω–µ—á–Ω–∞—è –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ (IP‚Åª¬π)

–û–±—Ä–∞—Ç–Ω–∞—è –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–µ.

```
IP‚Åª¬π = [40, 8, 48, 16, 56, 24, 64, 32,
        39, 7, 47, 15, 55, 23, 63, 31,
        38, 6, 46, 14, 54, 22, 62, 30,
        37, 5, 45, 13, 53, 21, 61, 29,
        36, 4, 44, 12, 52, 20, 60, 28,
        35, 3, 43, 11, 51, 19, 59, 27,
        34, 2, 42, 10, 50, 18, 58, 26,
        33, 1, 41,  9, 49, 17, 57, 25]
```

## –ü–æ–ª–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º DES

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

```
1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å IP –∫ –æ—Ç–∫—Ä—ã—Ç–æ–º—É —Ç–µ–∫—Å—Ç—É
2. –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ L‚ÇÄ –∏ R‚ÇÄ
3. –î–ª—è i = 1 –¥–æ 16:
    L_i = R_{i-1}
    R_i = L_{i-1} ‚äï F(R_{i-1}, K_i)
4. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å: R‚ÇÅ‚ÇÜ || L‚ÇÅ‚ÇÜ  (–æ–±—Ä–∞—Ç–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫!)
5. –ü—Ä–∏–º–µ–Ω–∏—Ç—å IP‚Åª¬π
6. –í–µ—Ä–Ω—É—Ç—å —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç
```

### –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

**–¢–æ—á–Ω–æ —Ç–∞–∫–æ–π –∂–µ –∞–ª–≥–æ—Ä–∏—Ç–º**, –Ω–æ –∫–ª—é—á–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ: K‚ÇÅ‚ÇÜ, K‚ÇÅ‚ÇÖ, ..., K‚ÇÅ

```
1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å IP –∫ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç—É
2. –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ R‚ÇÅ‚ÇÜ –∏ L‚ÇÅ‚ÇÜ
3. –î–ª—è i = 16 –¥–æ 1:
    R_{i-1} = L_i
    L_{i-1} = R_i ‚äï F(L_i, K_i)
4. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å: R‚ÇÄ || L‚ÇÄ
5. –ü—Ä–∏–º–µ–Ω–∏—Ç—å IP‚Åª¬π
6. –í–µ—Ä–Ω—É—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç
```

## –ö—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑ DES

### 1. –ü–µ—Ä–µ–±–æ—Ä –∫–ª—é—á–µ–π (Brute Force)

**–ü—Ä–æ–±–ª–µ–º–∞**: 2‚Åµ‚Å∂ ‚âà 7.2 √ó 10¬π‚Å∂ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∫–ª—é—á–µ–π

**–ò—Å—Ç–æ—Ä–∏—è –≤–∑–ª–æ–º–∞:**
- **1977**: —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–µ–Ω –∑–∞ $20 –º–ª–Ω (Diffie & Hellman)
- **1993**: $1 –º–ª–Ω, 3.5 —á–∞—Å–∞ (Wiener)
- **1998**: Deep Crack - –≤–∑–ª–æ–º –∑–∞ 56 —á–∞—Å–æ–≤ ($250,000)
- **1999**: distributed.net - –≤–∑–ª–æ–º –∑–∞ 22 —á–∞—Å–∞
- **–°–µ–≥–æ–¥–Ω—è**: –º–æ–∂–Ω–æ –≤–∑–ª–æ–º–∞—Ç—å –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤

### 2. –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç, –∫–∞–∫ —Ä–∞–∑–Ω–æ—Å—Ç–∏ –≤ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ç–µ–∫—Å—Ç–∞—Ö –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–∑–Ω–æ—Å—Ç–∏ –≤ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞—Ö.

**–¢—Ä–µ–±—É–µ—Ç—Å—è**: 2‚Å¥‚Å∑ –ø–∞—Ä –æ—Ç–∫—Ä—ã—Ç—ã–π-—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç
**–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ª—É—á—à–µ –ø–µ—Ä–µ–±–æ—Ä–∞, –Ω–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ä–µ–∞–ª—å–Ω–æ

### 3. –õ–∏–Ω–µ–π–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑

–ò—â–µ—Ç –ª–∏–Ω–µ–π–Ω—ã–µ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ –º–µ–∂–¥—É –±–∏—Ç–∞–º–∏ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞, —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞ –∏ –∫–ª—é—á–∞.

**–¢—Ä–µ–±—É–µ—Ç—Å—è**: 2‚Å¥¬≥ –ø–∞—Ä –∏–∑–≤–µ—Å—Ç–Ω—ã–π-–æ—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç  
**–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å–ª–æ–∂–Ω–æ

### 4. –£—è–∑–≤–∏–º–æ—Å—Ç–∏

- **–°–ª–∞–±—ã–µ –∫–ª—é—á–∏**: 4 –∫–ª—é—á–∞ –¥–∞—é—Ç E_K(E_K(M)) = M
- **–ü–æ–ª—É-—Å–ª–∞–±—ã–µ –∫–ª—é—á–∏**: 12 –ø–∞—Ä –∫–ª—é—á–µ–π –≤–∑–∞–∏–º–Ω–æ –æ–±—Ä–∞—Ç–Ω—ã
- **–ö–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–æ—Å—Ç—å**: E_K(M) = C ‚áí E_KÃÑ(MÃÑ) = CÃÑ

## –£—Å–∏–ª–µ–Ω–∏–µ DES: 3DES

### Triple DES (3DES)

```
C = E_K3(D_K2(E_K1(M)))
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –¥–ª–∏–Ω–∞ –∫–ª—é—á–∞: 168 –±–∏—Ç (3√ó56)
- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–æ–π–∫–æ—Å—Ç—å: ~112 –±–∏—Ç
- –°–∫–æ—Ä–æ—Å—Ç—å: –≤ 3 —Ä–∞–∑–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ DES

**–†–µ–∂–∏–º—ã 3DES:**
1. **3-Key 3DES**: K1 ‚â† K2 ‚â† K3 (—Å–∞–º—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π)
2. **2-Key 3DES**: K1 = K3 ‚â† K2 (–∫–æ–º–ø—Ä–æ–º–∏—Å—Å)


---

# –†–ï–ñ–ò–ú–´ –®–ò–§–†–û–í–ê–ù–ò–Ø (CIPHER MODES)

## –ó–∞—á–µ–º –Ω—É–∂–Ω—ã —Ä–µ–∂–∏–º—ã?

**–ü—Ä–æ–±–ª–µ–º–∞**: –±–ª–æ—á–Ω—ã–π —à–∏—Ñ—Ä —à–∏—Ñ—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –±–ª–æ–∫ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.

**–†–µ—à–µ–Ω–∏–µ**: —Ä–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–æ–≤.

## 1. ECB (Electronic Codebook)

### –û–ø–∏—Å–∞–Ω–∏–µ
–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Ä–µ–∂–∏–º - –∫–∞–∂–¥—ã–π –±–ª–æ–∫ —à–∏—Ñ—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.

### –ê–ª–≥–æ—Ä–∏—Ç–º

**–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
C_i = E_K(P_i)
```

**–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
P_i = D_K(C_i)
```

### –°—Ö–µ–º–∞
```
P‚ÇÅ P‚ÇÇ P‚ÇÉ P‚ÇÑ
 ‚Üì  ‚Üì  ‚Üì  ‚Üì
[E][E][E][E]  (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
 ‚Üì  ‚Üì  ‚Üì  ‚Üì
C‚ÇÅ C‚ÇÇ C‚ÇÉ C‚ÇÑ
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –±–ª–æ–∫–∞–º
- ‚úÖ –ù–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è –æ—à–∏–±–∫–∏

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå **–û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –±–ª–æ–∫–∏ ‚Üí –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç** (–æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞!)
- ‚ùå –í–∏–¥–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –£—è–∑–≤–∏–º –∫ –∞–Ω–∞–ª–∏–∑—É –ø–æ —á–∞—Å—Ç–æ—Ç–µ
- ‚ùå –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—Å—Ç–∞–≤–ª—è—Ç—å –±–ª–æ–∫–∏

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
**–ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨** –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö! –¢–æ–ª—å–∫–æ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–π.

## 2. CBC (Cipher Block Chaining)

### –û–ø–∏—Å–∞–Ω–∏–µ
–ö–∞–∂–¥—ã–π –±–ª–æ–∫ XOR-–∏—Ç—Å—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–æ–º –ø–µ—Ä–µ–¥ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º.

### –ê–ª–≥–æ—Ä–∏—Ç–º

**–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
C_0 = IV (Initialization Vector)
C_i = E_K(P_i ‚äï C_{i-1})
```

**–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
P_i = D_K(C_i) ‚äï C_{i-1}
```

### –°—Ö–µ–º–∞
```
IV  P‚ÇÅ     P‚ÇÇ     P‚ÇÉ
 ‚Üì   ‚Üì      ‚Üì      ‚Üì
 ‚îî‚Üí XOR    XOR    XOR
     ‚Üì      ‚Üì      ‚Üì
    [E]    [E]    [E]
     ‚Üì      ‚Üì      ‚Üì
    C‚ÇÅ ‚Üí‚Üí‚Üí C‚ÇÇ ‚Üí‚Üí‚Üí C‚ÇÉ
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –±–ª–æ–∫–∏ –¥–∞—é—Ç —Ä–∞–∑–Ω—ã–π —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç
- ‚úÖ –°–∫—Ä—ã–≤–∞–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- ‚úÖ –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–Ω–æ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å
- ‚úÖ –°–∞–º–æ–∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å (–æ—à–∏–±–∫–∞ –≤ C_i –≤–ª–∏—è–µ—Ç –Ω–∞ P_i –∏ P_{i+1})

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ (–Ω–µ–ª—å–∑—è —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å)
- ‚ùå –ù—É–∂–µ–Ω IV (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ª—É—á–∞–π–Ω—ã–º!)
- ‚ùå –û—à–∏–±–∫–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ 2 –±–ª–æ–∫–∞

### IV (Initialization Vector)
- –î–æ–ª–∂–µ–Ω –±—ã—Ç—å **—Å–ª—É—á–∞–π–Ω—ã–º** –∏ **—É–Ω–∏–∫–∞–ª—å–Ω—ã–º** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–µ–∫—Ä–µ—Ç–Ω—ã–º (–º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç–æ)
- –†–∞–∑–º–µ—Ä = —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
**–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω** –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ TLS, IPSec.

## 3. PCBC (Propagating Cipher Block Chaining)

### –û–ø–∏—Å–∞–Ω–∏–µ
–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è CBC, –≥–¥–µ —Ü–µ–ø–æ—á–∫–∞ –∑–∞–≤–∏—Å–∏—Ç –∏ –æ—Ç –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ, –∏ –æ—Ç —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞.

### –ê–ª–≥–æ—Ä–∏—Ç–º

**–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
C_0 = IV
C_i = E_K(P_i ‚äï P_{i-1} ‚äï C_{i-1})
```

**–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
P_i = D_K(C_i) ‚äï P_{i-1} ‚äï C_{i-1}
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –û—à–∏–±–∫–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –í–°–ï –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –±–ª–æ–∫–∏
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—Å—Ç–∞–≤–∫–∏/—É–¥–∞–ª–µ–Ω–∏—è –±–ª–æ–∫–æ–≤

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå –ù–µ–ª—å–∑—è —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å
- ‚ùå –û—à–∏–±–∫–∞ –ø–æ—Ä—Ç–∏—Ç –≤—Å—ë —Å–æ–æ–±—â–µ–Ω–∏–µ

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Kerberos –≤–µ—Ä—Å–∏–∏ 4.

## 4. CFB (Cipher Feedback)

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –±–ª–æ—á–Ω—ã–π —à–∏—Ñ—Ä –≤ **—Å–∞–º–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—â–∏–π—Å—è –ø–æ—Ç–æ–∫–æ–≤—ã–π —à–∏—Ñ—Ä**.

### –ê–ª–≥–æ—Ä–∏—Ç–º (CFB-8, –ø–æ 1 –±–∞–π—Ç—É)

**–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
I_1 = IV
C_i = P_i ‚äï MSB_s(E_K(I_i))
I_{i+1} = (I_i << s) | C_i
```

**–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
I_1 = IV
P_i = C_i ‚äï MSB_s(E_K(I_i))
I_{i+1} = (I_i << s) | C_i
```

–≥–¥–µ MSB_s - s —Å—Ç–∞—Ä—à–∏—Ö –±–∏—Ç

### –°—Ö–µ–º–∞ (–ø–æ–ª–Ω–æ–±–ª–æ—á–Ω—ã–π CFB)
```
IV      P‚ÇÅ     P‚ÇÇ     P‚ÇÉ
 ‚Üì       ‚Üì      ‚Üì      ‚Üì
[E] ‚Üí XOR     XOR    XOR
      ‚Üì  ‚Üì     ‚Üì      ‚Üì
      C‚ÇÅ [E] ‚Üí C‚ÇÇ ‚Üí‚Üí C‚ÇÉ
         ‚Üì
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ù–µ –Ω—É–∂–Ω–∞ –Ω–∞–±–∏–≤–∫–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ–ø–æ–ª–Ω—ã–º–∏ –±–ª–æ–∫–∞–º–∏)
- ‚úÖ –°–∞–º–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–ø–æ—Å–ª–µ s –±–∏—Ç –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è)
- ‚úÖ –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–Ω–æ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ
- ‚ùå –û—à–∏–±–∫–∞ –≤ C_i –ø–æ—Ä—Ç–∏—Ç P_i –∏ —Å–ª–µ–¥—É—é—â–∏–µ s –±–∏—Ç

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
TLS, OpenPGP.

## 5. OFB (Output Feedback)

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –±–ª–æ—á–Ω—ã–π —à–∏—Ñ—Ä –≤ **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫–æ–≤—ã–π —à–∏—Ñ—Ä**.

### –ê–ª–≥–æ—Ä–∏—Ç–º

**–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
I_0 = IV
I_i = E_K(I_{i-1})
C_i = P_i ‚äï I_i
```

**–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
I_0 = IV
I_i = E_K(I_{i-1})
P_i = C_i ‚äï I_i
```

### –°—Ö–µ–º–∞
```
IV
 ‚Üì
[E]
 ‚Üì
[E] ‚Üí I‚ÇÅ   P‚ÇÅ
 ‚Üì     ‚Üì    ‚Üì
[E] ‚Üí XOR ‚Üí C‚ÇÅ
      ‚Üì
     I‚ÇÇ   P‚ÇÇ
      ‚Üì    ‚Üì
     XOR ‚Üí C‚ÇÇ
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ù–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è –æ—à–∏–±–∫–∏ (–æ—à–∏–±–∫–∞ –≤ C_i –ø–æ—Ä—Ç–∏—Ç —Ç–æ–ª—å–∫–æ P_i)
- ‚úÖ –ú–æ–∂–Ω–æ –ø—Ä–µ–¥–≤—ã—á–∏—Å–ª–∏—Ç—å –∫–ª—é—á–µ–≤–æ–π –ø–æ—Ç–æ–∫
- ‚úÖ –ù–µ –Ω—É–∂–Ω–∞ –Ω–∞–±–∏–≤–∫–∞

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå –ù–µ–ª—å–∑—è —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å
- ‚ùå IV –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è —Å —Ç–µ–º –∂–µ –∫–ª—é—á–æ–º

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
–ü–æ—Ç–æ–∫–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–æ–≤.

## 6. CTR (Counter)

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –±–ª–æ—á–Ω—ã–π —à–∏—Ñ—Ä –≤ **–ø–æ—Ç–æ–∫–æ–≤—ã–π —à–∏—Ñ—Ä** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—á–µ—Ç—á–∏–∫–∞.

### –ê–ª–≥–æ—Ä–∏—Ç–º

**–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
C_i = P_i ‚äï E_K(Nonce || Counter_i)
```

**–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
P_i = C_i ‚äï E_K(Nonce || Counter_i)
```

–≥–¥–µ Counter_i = Counter_0 + i

### –°—Ö–µ–º–∞
```
Nonce+0   Nonce+1   Nonce+2
   ‚Üì         ‚Üì         ‚Üì
  [E]       [E]       [E]   (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ!)
   ‚Üì         ‚Üì         ‚Üì
  XOR       XOR       XOR
   ‚Üì         ‚Üì         ‚Üì
  C‚ÇÅ        C‚ÇÇ        C‚ÇÉ
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ **–ü–æ–ª–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º** —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –±–ª–æ–∫–∞–º
- ‚úÖ –ù–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è –æ—à–∏–±–∫–∏
- ‚úÖ –ù–µ –Ω—É–∂–Ω–∞ –Ω–∞–±–∏–≤–∫–∞
- ‚úÖ –ü—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞
- ‚úÖ –û–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è (—Ç–æ–ª—å–∫–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå Nonce+Counter –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
**–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç!** IPSec, TLS 1.3, GCM mode.

## 7. RANDOM DELTA

### –û–ø–∏—Å–∞–Ω–∏–µ
–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ª—É—á–∞–π–Ω–æ–π –¥–µ–ª—å—Ç—ã.

### –ê–ª–≥–æ—Ä–∏—Ç–º

**–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
Delta_i = E_K(Random_i)
C_i = P_i ‚äï Delta_i
```

**–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
```
Delta_i = E_K(Random_i)
P_i = C_i ‚äï Delta_i
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–¥–∞—á–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤–º–µ—Å—Ç–µ —Å —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–æ–º
- –í—ã—Å–æ–∫–∞—è –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å
- –†–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤

| –†–µ–∂–∏–º | –ü–∞—Ä–∞–ª–ª–µ–ª—å —à–∏—Ñ—Ä. | –ü–∞—Ä–∞–ª–ª–µ–ª—å –¥–µ—à–∏—Ñ—Ä. | –†–∞—Å–ø—Ä. –æ—à–∏–±–æ–∫ | –ù–∞–±–∏–≤–∫–∞ | IV |
|-------|----------------|-------------------|---------------|---------|-----|
| ECB   | ‚úÖ –î–∞          | ‚úÖ –î–∞             | –ù–µ—Ç           | –î–∞      | –ù–µ—Ç |
| CBC   | ‚ùå –ù–µ—Ç         | ‚úÖ –î–∞             | 2 –±–ª–æ–∫–∞       | –î–∞      | –î–∞  |
| PCBC  | ‚ùå –ù–µ—Ç         | ‚ùå –ù–µ—Ç            | –í—Å–µ           | –î–∞      | –î–∞  |
| CFB   | ‚ùå –ù–µ—Ç         | ‚úÖ –î–∞             | s+1 –±–∏—Ç       | –ù–µ—Ç     | –î–∞  |
| OFB   | ‚ùå –ù–µ—Ç         | ‚ùå –ù–µ—Ç            | 1 –±–ª–æ–∫        | –ù–µ—Ç     | –î–∞  |
| CTR   | ‚úÖ –î–∞          | ‚úÖ –î–∞             | 1 –±–ª–æ–∫        | –ù–µ—Ç     | Nonce |

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É

### –î–ª—è —Ñ–∞–π–ª–æ–≤ –∏ –¥–∏—Å–∫–æ–≤
- **CBC** - –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä
- **CTR** - –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º

### –î–ª—è —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- **CTR** —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (GCM)
- **CBC** –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### –î–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **CFB** - –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —Å–∞–º–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- **OFB** –∏–ª–∏ **CTR** - –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã

### –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- **ECB** - –Ω–∏–∫–æ–≥–¥–∞ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö!
- **PCBC** - —É—Å—Ç–∞—Ä–µ–ª

---

# –†–ï–ñ–ò–ú–´ –ù–ê–ë–ò–í–ö–ò (PADDING MODES)

## –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –Ω–∞–±–∏–≤–∫–∞?

–ë–ª–æ—á–Ω—ã–µ —à–∏—Ñ—Ä—ã —Ç—Ä–µ–±—É—é—Ç, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∫—Ä–∞—Ç–Ω—ã —Ä–∞–∑–º–µ—Ä—É –±–ª–æ–∫–∞. **–ù–∞–±–∏–≤–∫–∞** (padding) –¥–æ–ø–æ–ª–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–ª–æ–∫ –¥–æ –Ω—É–∂–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.

## 1. ZEROS (–ù—É–ª–µ–≤–∞—è –Ω–∞–±–∏–≤–∫–∞)

### –ê–ª–≥–æ—Ä–∏—Ç–º

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ:**
```
–î–æ–ø–æ–ª–Ω–∏—Ç—å –Ω—É–ª—è–º–∏ –¥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞:
[D‚ÇÅ D‚ÇÇ D‚ÇÉ 00 00 00 00 00]
```

**–£–¥–∞–ª–µ–Ω–∏–µ:**
```
–£–¥–∞–ª–∏—Ç—å trailing –Ω—É–ª–∏
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå **–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è –Ω—É–ª—è–º–∏!**
- ‚ùå –ù–µ–ª—å–∑—è –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≥—Ä–∞–Ω–∏—Ü—É –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
–¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è –Ω—É–ª—è–º–∏.

## 2. ANSI X.923

### –ê–ª–≥–æ—Ä–∏—Ç–º

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ:**
```
–î–æ–ø–æ–ª–Ω–∏—Ç—å –Ω—É–ª—è–º–∏, –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞–π—Ç = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –±–∞–π—Ç:

–ü—Ä–∏–º–µ—Ä (blockSize=8, dataSize=3):
[D‚ÇÅ D‚ÇÇ D‚ÇÉ 00 00 00 00 05]
              ^^^^^^^^^ ^^
              –Ω—É–ª–∏      –∫–æ–ª-–≤–æ
```

**–£–¥–∞–ª–µ–Ω–∏–µ:**
```
1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞–π—Ç N
2. –£–¥–∞–ª–∏—Ç—å N –±–∞–π—Ç
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ N-1 –±–∞–π—Ç - –Ω—É–ª–∏
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –û–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå –ú–µ–Ω–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω, —á–µ–º PKCS7

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞—Ö ANSI.

## 3. PKCS#7 (PKCS7)

### –ê–ª–≥–æ—Ä–∏—Ç–º

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ:**
```
–î–æ–±–∞–≤–∏—Ç—å N –±–∞–π—Ç, –∫–∞–∂–¥—ã–π —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º N:

–ü—Ä–∏–º–µ—Ä—ã (blockSize=8):

dataSize=3:  [D‚ÇÅ D‚ÇÇ D‚ÇÉ 05 05 05 05 05]
dataSize=7:  [D‚ÇÅ...D‚Çá 01]
dataSize=8:  [D‚ÇÅ...D‚Çà 08 08 08 08 08 08 08 08]  (—Ü–µ–ª—ã–π –±–ª–æ–∫!)
             ^^^^^^^^^  ^^^^^^^^^^^^^^^^^^^^^^
             –¥–∞–Ω–Ω—ã–µ     –Ω–∞–±–∏–≤–∫–∞
```

**–£–¥–∞–ª–µ–Ω–∏–µ:**
```
1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞–π—Ç N
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –±–∞–π—Ç –≤—Å–µ —Ä–∞–≤–Ω—ã N
3. –£–¥–∞–ª–∏—Ç—å N –±–∞–π—Ç
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ **–°–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç**
- ‚úÖ –í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ç—è –±—ã 1 –±–∞–π—Ç (–¥–∞–∂–µ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∫—Ä–∞—Ç–Ω—ã –±–ª–æ–∫—É)
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ –û–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå –î–æ–±–∞–≤–ª—è–µ—Ç —Ü–µ–ª—ã–π –±–ª–æ–∫, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –∫—Ä–∞—Ç–Ω—ã

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
**–°—Ç–∞–Ω–¥–∞—Ä—Ç –¥–µ-—Ñ–∞–∫—Ç–æ**: TLS, CMS, S/MIME, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫—Ä–∏–ø—Ç–æ–±–∏–±–ª–∏–æ—Ç–µ–∫.

## 4. ISO 10126

### –ê–ª–≥–æ—Ä–∏—Ç–º

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ:**
```
–î–æ–ø–æ–ª–Ω–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–º–∏ –±–∞–π—Ç–∞–º–∏, –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞–π—Ç = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:

–ü—Ä–∏–º–µ—Ä (blockSize=8, dataSize=3):
[D‚ÇÅ D‚ÇÇ D‚ÇÉ A7 3F 82 C1 05]
           ^^^^^^^^^^^ ^^
           —Å–ª—É—á–∞–π–Ω—ã–µ   –∫–æ–ª-–≤–æ
```

**–£–¥–∞–ª–µ–Ω–∏–µ:**
```
1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞–π—Ç N
2. –£–¥–∞–ª–∏—Ç—å N –±–∞–π—Ç (–Ω–µ –ø—Ä–æ–≤–µ—Ä—è—è –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è)
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –°–ª—É—á–∞–π–Ω–æ—Å—Ç—å –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑
- ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå –ù—É–∂–µ–Ω –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
- ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–µ–µ PKCS7
- ‚ùå –ù–µ–ª—å–∑—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å padding

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∂–µ, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ –Ω–∞–±–∏–≤–∫–∏

| –†–µ–∂–∏–º | –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å | –ü—Ä–æ–≤–µ—Ä–∫–∞ | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å |
|-------|---------------------|----------|--------------|--------------|
| ZEROS | –î–∞ | –ù–µ—Ç | ‚ùå –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–∞—è |
| ANSI X.923 | –î–∞ | –ß–∞—Å—Ç–∏—á–Ω–∞—è | ‚úÖ –•–æ—Ä–æ—à–∞—è | –°—Ä–µ–¥–Ω—è—è |
| PKCS7 | –î–∞ | –ü–æ–ª–Ω–∞—è | ‚úÖ –•–æ—Ä–æ—à–∞—è | ‚≠ê –í—ã—Å–æ–∫–∞—è |
| ISO 10126 | –ù–µ—Ç | –ù–µ—Ç | ‚úÖ –û—Ç–ª–∏—á–Ω–∞—è | –ù–∏–∑–∫–∞—è |

## –ê—Ç–∞–∫–∏ –Ω–∞ –Ω–∞–±–∏–≤–∫—É

### Padding Oracle Attack

–ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä —Å–æ–æ–±—â–∞–µ—Ç –æ–± –æ—à–∏–±–∫–µ –Ω–∞–±–∏–≤–∫–∏, –∞—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç:
1. –£–∑–Ω–∞—Ç—å, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞ –ª–∏ –Ω–∞–±–∏–≤–∫–∞
2. –ü–æ–¥–æ–±—Ä–∞—Ç—å –±–∞–π—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏—è
3. **–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤—Å—ë —Å–æ–æ–±—â–µ–Ω–∏–µ –±–µ–∑ –∑–Ω–∞–Ω–∏—è –∫–ª—é—á–∞!**

**–ó–∞—â–∏—Ç–∞**: –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–∞—Ö –Ω–∞–±–∏–≤–∫–∏ (–≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ—Ç–≤–µ—Ç).


---

# –ó–ê–î–ê–ù–ò–ï 6: –ê–õ–ì–û–†–ò–¢–ú DEAL

## –ò—Å—Ç–æ—Ä–∏—è –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ DES
- –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞: **—Ç–æ–ª—å–∫–æ 64 –±–∏—Ç–∞** - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞: **—Ç–æ–ª—å–∫–æ 56 –±–∏—Ç** - –ª–µ–≥–∫–æ –≤–∑–ª–æ–º–∞—Ç—å –ø–µ—Ä–µ–±–æ—Ä–æ–º

### –†–µ—à–µ–Ω–∏–µ: DEAL

**DEAL** (Data Encryption Algorithm with Larger blocks) - –∞–ª–≥–æ—Ä–∏—Ç–º, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π Lars Knudsen –≤ 1998 –≥–æ–¥—É.

**–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **DES –∫–∞–∫ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π –±–ª–æ–∫** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ–ª–µ–µ —Å–∏–ª—å–Ω–æ–≥–æ —à–∏—Ñ—Ä–∞.

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã DEAL

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ | **128 –±–∏—Ç** (16 –±–∞–π—Ç) - –≤ 2 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ DES |
| –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞ | **192 –±–∏—Ç–∞** (24 –±–∞–π—Ç–∞) - 3 –∫–ª—é—á–∞ DES |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤ | **6** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –∏–ª–∏ 8 |
| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ | –°–µ—Ç—å –§–µ–π—Å—Ç–µ–ª—è |
| –†–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏—è F | **DES** |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ DEAL

### –û–±—â–∞—è —Å—Ö–µ–º–∞

```
–û—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç (128 –±–∏—Ç)
        ‚Üì
    –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ L‚ÇÄ –∏ R‚ÇÄ (–ø–æ 64 –±–∏—Ç–∞)
        ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  6 —Ä–∞—É–Ω–¥–æ–≤ –§–µ–π—Å—Ç–µ–ª—è       ‚îÇ
    ‚îÇ  F(R, K) = DES(R, K)      ‚îÇ
    ‚îÇ                           ‚îÇ
    ‚îÇ  –†–∞—É–Ω–¥ 1: K‚ÇÅ (DES key 1)  ‚îÇ
    ‚îÇ  –†–∞—É–Ω–¥ 2: K‚ÇÇ (DES key 2)  ‚îÇ
    ‚îÇ  –†–∞—É–Ω–¥ 3: K‚ÇÉ (DES key 3)  ‚îÇ
    ‚îÇ  –†–∞—É–Ω–¥ 4: K‚ÇÅ (–ø–æ–≤—Ç–æ—Ä)     ‚îÇ
    ‚îÇ  –†–∞—É–Ω–¥ 5: K‚ÇÇ (–ø–æ–≤—Ç–æ—Ä)     ‚îÇ
    ‚îÇ  –†–∞—É–Ω–¥ 6: K‚ÇÉ (–ø–æ–≤—Ç–æ—Ä)     ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üì
    –û–±–º–µ–Ω –ø–æ–ª–æ–≤–∏–Ω: (R‚ÇÜ, L‚ÇÜ)
        ‚Üì
    –®–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç (128 –±–∏—Ç)
```

### –†–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏—è F

**–ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å**: F = DES!

```
F(R, K_i) = DES_encrypt(R, K_i)

–≥–¥–µ:
- R - 64-–±–∏—Ç–Ω–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ –±–ª–æ–∫–∞
- K_i - –æ–¥–∏–Ω –∏–∑ —Ç—Ä–µ—Ö 64-–±–∏—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π DES
```

### –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∫–ª—é—á–µ–π

–ò–∑ 192-–±–∏—Ç–Ω–æ–≥–æ –≥–ª–∞–≤–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è 3 –∫–ª—é—á–∞ DES:

```
–ì–ª–∞–≤–Ω—ã–π –∫–ª—é—á (192 –±–∏—Ç–∞ = 24 –±–∞–π—Ç–∞)
        ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ   K‚ÇÅ    ‚îÇ   K‚ÇÇ    ‚îÇ   K‚ÇÉ    ‚îÇ
    ‚îÇ (8 –±–∞–π—Ç)‚îÇ (8 –±–∞–π—Ç)‚îÇ (8 –±–∞–π—Ç)‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì         ‚Üì         ‚Üì
    –†–∞—É–Ω–¥—ã:  1,4   2,5   3,6
```

**–ü–æ—Ä—è–¥–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–π:**
- –†–∞—É–Ω–¥ 1: K‚ÇÅ
- –†–∞—É–Ω–¥ 2: K‚ÇÇ
- –†–∞—É–Ω–¥ 3: K‚ÇÉ
- –†–∞—É–Ω–¥ 4: K‚ÇÅ (–ø–æ–≤—Ç–æ—Ä)
- –†–∞—É–Ω–¥ 5: K‚ÇÇ (–ø–æ–≤—Ç–æ—Ä)
- –†–∞—É–Ω–¥ 6: K‚ÇÉ (–ø–æ–≤—Ç–æ—Ä)

## –ê–ª–≥–æ—Ä–∏—Ç–º DEAL

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

```
–í—Ö–æ–¥: plaintext (128 –±–∏—Ç), key (192 –±–∏—Ç–∞)

1. –†–∞–∑–¥–µ–ª–∏—Ç—å plaintext –Ω–∞ L‚ÇÄ || R‚ÇÄ (–ø–æ 64 –±–∏—Ç–∞)

2. –î–ª—è i = 1 –¥–æ 6:
    keyIndex = ((i - 1) mod 3)  // 0, 1, 2, 0, 1, 2
    K = extractKey(key, keyIndex)  // K‚ÇÅ, K‚ÇÇ –∏–ª–∏ K‚ÇÉ
    
    L_i = R_{i-1}
    R_i = L_{i-1} ‚äï DES_encrypt(R_{i-1}, K)

3. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å: ciphertext = R‚ÇÜ || L‚ÇÜ  (–æ–±—Ä–∞—Ç–∏—Ç—å!)

4. –í–µ—Ä–Ω—É—Ç—å ciphertext
```

### –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

```
–í—Ö–æ–¥: ciphertext (128 –±–∏—Ç), key (192 –±–∏—Ç–∞)

1. –†–∞–∑–¥–µ–ª–∏—Ç—å ciphertext –Ω–∞ R‚ÇÜ || L‚ÇÜ

2. –î–ª—è i = 6 –¥–æ 1 (–≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ):
    keyIndex = ((i - 1) mod 3)
    K = extractKey(key, keyIndex)
    
    R_{i-1} = L_i
    L_{i-1} = R_i ‚äï DES_encrypt(L_i, K)

3. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å: plaintext = L‚ÇÄ || R‚ÇÄ

4. –í–µ—Ä–Ω—É—Ç—å plaintext
```

## –ü–∞—Ç—Ç–µ—Ä–Ω –ê–¥–∞–ø—Ç–µ—Ä (Adapter Pattern)

### –ü—Ä–æ–±–ª–µ–º–∞

–£ –Ω–∞—Å –µ—Å—Ç—å:
- `FeistelCipher` - —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `RoundFunction`
- `DES` - —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `SymmetricCipher`

**–û–Ω–∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã!**

### –†–µ—à–µ–Ω–∏–µ: DESAdapter

**–ê–¥–∞–ø—Ç–µ—Ä** - –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –æ–±—ä–µ–∫—Ç–∞–º —Å –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –≤–º–µ—Å—Ç–µ.

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   FeistelCipher     ‚îÇ
‚îÇ  (—Ç—Ä–µ–±—É–µ—Ç           ‚îÇ
‚îÇ   RoundFunction)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚Üì –∏—Å–ø–æ–ª—å–∑—É–µ—Ç
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    DESAdapter        ‚îÇ  ‚Üê –ê–î–ê–ü–¢–ï–†
‚îÇ  implements          ‚îÇ
‚îÇ  RoundFunction       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚Üì —Å–æ–¥–µ—Ä–∂–∏—Ç
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ       DES            ‚îÇ  ‚Üê –ê–î–ê–ü–¢–ò–†–£–ï–ú–´–ô
‚îÇ  implements          ‚îÇ
‚îÇ  SymmetricCipher     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è DESAdapter

```java
public class DESAdapter implements RoundFunction {
    private DES des;
    
    public DESAdapter() {
        this.des = new DES();
    }
    
    @Override
    public byte[] apply(byte[] data, byte[] roundKey) {
        // –ê–¥–∞–ø—Ç–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑—É–µ–º DES –∫–∞–∫ —Ä–∞—É–Ω–¥-—Ñ—É–Ω–∫—Ü–∏—é
        des.setEncryptionKey(roundKey);
        return des.encryptBlock(data);
    }
    
    @Override
    public int getBlockSize() {
        return des.getBlockSize();  // 8 –±–∞–π—Ç
    }
}
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞–¥–∞–ø—Ç–µ—Ä–∞

1. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞**: –Ω–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å DES
2. **–ì–∏–±–∫–æ—Å—Ç—å**: –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å DES –Ω–∞ –¥—Ä—É–≥–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º
3. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**: DES –æ—Å—Ç–∞–µ—Ç—Å—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å DEAL

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–∞–¥ DES

| –ê—Å–ø–µ–∫—Ç | DES | DEAL |
|--------|-----|------|
| –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ | 64 –±–∏—Ç–∞ | **128 –±–∏—Ç** ‚úÖ |
| –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞ | 56 –±–∏—Ç | **168 –±–∏—Ç** (3√ó56) ‚úÖ |
| –†–∞—É–Ω–¥–æ–≤ | 16 | 6 |
| –°–∫–æ—Ä–æ—Å—Ç—å | –ë—ã—Å—Ç—Ä–µ–µ | –ú–µ–¥–ª–µ–Ω–Ω–µ–µ (~3√óDES) |

### –ö—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑ DEAL

**DEAL-6** (6 —Ä–∞—É–Ω–¥–æ–≤):
- –°—Ç–æ–π–∫–æ—Å—Ç—å: ~2¬π¬≤‚Å∞ –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π –∫ –∏–∑–≤–µ—Å—Ç–Ω—ã–º –∞—Ç–∞–∫–∞–º

**DEAL-8** (8 —Ä–∞—É–Ω–¥–æ–≤):
- –°—Ç–æ–π–∫–æ—Å—Ç—å: ~2¬π‚Å∂‚Å∞ –æ–ø–µ—Ä–∞—Ü–∏–π
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –∞—Ç–∞–∫–∏

1. **Meet-in-the-middle**: —Ç—Ä–µ–±—É–µ—Ç 2¬π¬π¬≤ –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è DEAL-6
2. **–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑**: 2¬π¬π‚Åµ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
3. **–õ–∏–Ω–µ–π–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑**: –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–ø—Ä–∏–º–µ–Ω–∏–º

### –í—ã–≤–æ–¥

DEAL –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ DES, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:
- –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π
- –°–∏—Å—Ç–µ–º, –≥–¥–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ —à–∏—Ñ—Ä–æ–≤

---

# –ü–ê–¢–¢–ï–†–ù–´ –ü–†–û–ï–ö–¢–ò–†–û–í–ê–ù–ò–Ø

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### 1. Strategy (–°—Ç—Ä–∞—Ç–µ–≥–∏—è)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: `CipherMode`, `PaddingMode`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç —Å–µ–º–µ–π—Å—Ç–≤–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ –¥–µ–ª–∞–µ—Ç –∏—Ö –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã–º–∏.

```java
public enum CipherMode {
    ECB {
        public byte[] encrypt(...) { /* —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ECB */ }
    },
    CBC {
        public byte[] encrypt(...) { /* —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è CBC */ }
    },
    // ... –¥—Ä—É–≥–∏–µ —Ä–µ–∂–∏–º—ã
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ä–µ–∂–∏–º
- –ö–ª–∏–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ò–∑–±–µ–≥–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

### 2. Template Method (–®–∞–±–ª–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: `FeistelCipher`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–∫–µ–ª–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∞, –¥–µ–ª–µ–≥–∏—Ä—É—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —à–∞–≥–∏ –ø–æ–¥–∫–ª–∞—Å—Å–∞–º.

```java
public abstract class FeistelCipher {
    // –®–∞–±–ª–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥
    public final byte[] encryptBlock(byte[] plaintext) {
        byte[] L = getLeftHalf(plaintext);
        byte[] R = getRightHalf(plaintext);
        
        for (int i = 0; i < getRounds(); i++) {
            byte[] newL = R;
            byte[] newR = xor(L, applyRoundFunction(R, i));
            L = newL;
            R = newR;
        }
        
        return concatenate(R, L);
    }
    
    // –ü–æ–¥–∫–ª–∞—Å—Å—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç —ç—Ç–∏ –º–µ—Ç–æ–¥—ã
    protected abstract byte[] applyRoundFunction(byte[] data, int round);
    protected abstract int getRounds();
}
```

### 3. Adapter (–ê–¥–∞–ø—Ç–µ—Ä)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: `DESAdapter`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–ª–∞—Å—Å–∞ –∫ –¥—Ä—É–≥–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.

```java
public class DESAdapter implements RoundFunction {
    private DES des;  // –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º—ã–π –æ–±—ä–µ–∫—Ç
    
    public byte[] apply(byte[] data, byte[] key) {
        // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        des.setEncryptionKey(key);
        return des.encryptBlock(data);
    }
}
```

### 4. Factory Method (–§–∞–±—Ä–∏—á–Ω—ã–π –º–µ—Ç–æ–¥)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: —Å–æ–∑–¥–∞–Ω–∏–µ `CipherContext`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ–¥–∫–ª–∞—Å—Å–∞–º.

```java
public class CipherContext {
    public static CipherContext create(
        String algorithm,
        byte[] key,
        CipherMode mode,
        PaddingMode padding
    ) {
        SymmetricCipher cipher = switch (algorithm) {
            case "DES" -> new DES();
            case "DEAL" -> new DEAL();
            default -> throw new IllegalArgumentException();
        };
        return new CipherContext(cipher, key, mode, padding, ...);
    }
}
```

### 5. Composite (–ö–æ–º–ø–æ–Ω–æ–≤—â–∏–∫)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ä–µ–∂–∏–º–æ–≤ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –∫–æ–º–ø–æ–Ω—É–µ—Ç –æ–±—ä–µ–∫—Ç—ã –≤ –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

### 6. Decorator (–î–µ–∫–æ—Ä–∞—Ç–æ—Ä)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (IV, –ø–∞–¥–¥–∏–Ω–≥)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç–∞–º –Ω–æ–≤—ã–µ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏.

---

# –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ò –†–ï–ó–£–õ–¨–¢–ê–¢–´

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –£—Ä–æ–≤–Ω–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### 1. Unit Tests (–ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã)
–¢–µ—Å—Ç–∏—Ä—É—é—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `BitPermutation`
- `DES` (—Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ —Ç–µ—Å—Ç-–≤–µ–∫—Ç–æ—Ä–∞–º–∏)
- `FeistelCipher`
- `DEAL`

#### 2. Integration Tests (–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã)
–¢–µ—Å—Ç–∏—Ä—É—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
- `CipherContext` + —Ä–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- `DEAL` + `DESAdapter`

#### 3. System Tests (–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–µ—Å—Ç—ã)
–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ä–µ–∂–∏–º–æ–≤

## –¢–µ—Å—Ç–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä—ã DES

### –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç-–≤–µ–∫—Ç–æ—Ä—ã

```
# –¢–µ—Å—Ç 1: –ù—É–ª–µ–≤–æ–π –∫–ª—é—á –∏ —Ç–µ–∫—Å—Ç
–ö–ª—é—á:        0000000000000000
–û—Ç–∫—Ä—ã—Ç—ã–π:    0000000000000000
–®–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç:  4C598ED6C272135B

# –¢–µ—Å—Ç 2: –ü—Ä–æ—Å—Ç–æ–π –∫–ª—é—á
–ö–ª—é—á:        FFFFFFFFFFFFFFFF
–û—Ç–∫—Ä—ã—Ç—ã–π:    FFFFFFFFFFFFFFFF
–®–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç:  4BE864CDCADB1CCE

# –¢–µ—Å—Ç 3: –°–º–µ—à–∞–Ω–Ω—ã–π
–ö–ª—é—á:        0123456789ABCDEF
–û—Ç–∫—Ä—ã—Ç—ã–π:    0000000000000001
–®–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç:  243F1A708C242821
```

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –ü–æ–∫—Ä—ã—Ç–∏–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Å—Ç–æ–≤ | –ü–æ–∫—Ä—ã—Ç–∏–µ |
|-----------|--------|----------|
| BitPermutation | 6 | 100% |
| Interfaces | 7 | 95% |
| Feistel | 6 | 100% |
| DES | 7 | 98% |
| DEAL | 10 | 100% |
| **–ò–¢–û–ì–û** | **36** | **98%** |

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–Ω–∞ Intel i7)

| –ê–ª–≥–æ—Ä–∏—Ç–º | –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ | –°–∫–æ—Ä–æ—Å—Ç—å | –û–ø–µ—Ä–∞—Ü–∏—è |
|----------|--------------|----------|----------|
| DES | 64 –±–∏—Ç–∞ | ~0.3 –ú–ë/—Å | 1 –ö–ë —Ñ–∞–π–ª |
| DES | 64 –±–∏—Ç–∞ | ~0.37 –ú–ë/—Å | 126 –ö–ë MP3 |
| DES | 64 –±–∏—Ç–∞ | ~0.31 –ú–ë/—Å | 1 –ú–ë –≤–∏–¥–µ–æ |
| DEAL | 128 –±–∏—Ç | ~0.1 –ú–ë/—Å | –†–∞—Å—á–µ—Ç–Ω–æ |

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–π

### –ó–∞–¥–∞–Ω–∏–µ 5: DES –¥–ª—è —Ñ–∞–π–ª–æ–≤

‚úÖ **–ü—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: 64, 256, 1024, 4096 –±–∞–π—Ç - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  
‚úÖ **–¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã**: 659 –±–∞–π—Ç - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  
‚úÖ **–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥**: 617 –±–∞–π—Ç Java - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  
‚úÖ **–ë–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã**: 8192 –±–∞–π—Ç - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  
‚úÖ **PNG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: 19 –ö–ë - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  
‚úÖ **MP3 –∞—É–¥–∏–æ**: 126 –ö–ë - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  
‚úÖ **MOV –≤–∏–¥–µ–æ**: 1 –ú–ë - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  

### –ó–∞–¥–∞–Ω–∏–µ 7: DEAL –¥–ª—è —Ñ–∞–π–ª–æ–≤

‚úÖ **–ü—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: 64, 256, 1024, 4096 –±–∞–π—Ç - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  
‚úÖ **–¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã**: 531 –±–∞–π—Ç - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  
‚úÖ **PNG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: 1 –ö–ë (—Ç–µ—Å—Ç–æ–≤–æ–µ) - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ  
‚úÖ **MP3 –∞—É–¥–∏–æ**: 8 –ö–ë (—Ç–µ—Å—Ç–æ–≤–æ–µ) - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  
‚úÖ **MOV –≤–∏–¥–µ–æ**: 16 –ö–ë (—Ç–µ—Å—Ç–æ–≤–æ–µ) - 100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ  

---

# –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –ê–°–ü–ï–ö–¢–´

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

```java
// –°–æ–∑–¥–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º
DES des = new DES();

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–ª—é—á
byte[] key = {0x01, 0x23, 0x45, 0x67, (byte)0x89, 
              (byte)0xAB, (byte)0xCD, (byte)0xEF};
des.setEncryptionKey(key);
des.setDecryptionKey(key);

// –ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –±–ª–æ–∫
byte[] plaintext = "Hello!!!".getBytes();  // 8 –±–∞–π—Ç
byte[] ciphertext = des.encryptBlock(plaintext);

// –î–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å
byte[] decrypted = des.decryptBlock(ciphertext);
```

### –ü—Ä–∏–º–µ—Ä 2: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∂–∏–º–∞–º–∏

```java
// –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç
DES des = new DES();
byte[] key = generateRandomKey();
byte[] iv = generateRandomIV();

CipherContext ctx = new CipherContext(
    des,                    // –ê–ª–≥–æ—Ä–∏—Ç–º
    key,                    // –ö–ª—é—á
    CipherMode.CBC,         // –†–µ–∂–∏–º
    PaddingMode.PKCS7,      // –ù–∞–±–∏–≤–∫–∞
    8,                      // –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞
    iv                      // IV
);

// –ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
byte[] plaintext = "–î–ª–∏–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...".getBytes();
byte[][] result = new byte[1][];
ctx.encryptAsync(plaintext, result).join();
byte[] ciphertext = result[0];

// –î–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å
byte[][] decResult = new byte[1][];
ctx.decryptAsync(ciphertext, decResult).join();
byte[] decrypted = decResult[0];

// –ó–∞–∫—Ä—ã—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç
ctx.shutdown();
```

### –ü—Ä–∏–º–µ—Ä 3: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```java
CipherContext ctx = new CipherContext(
    new DES(),
    key,
    CipherMode.CBC,
    PaddingMode.PKCS7,
    8,
    iv
);

// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
ctx.encryptFileAsync("document.txt", "document.txt.enc")
   .thenRun(() -> System.out.println("–ì–æ—Ç–æ–≤–æ!"))
   .join();

ctx.shutdown();
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### ‚ùå –ù–ï –î–ï–õ–ê–¢–¨

1. **–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DES –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ**
   - –í–∑–ª–∞–º—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–±–æ—Ä–æ–º –∑–∞ —á–∞—Å—ã
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ AES-256

2. **–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ECB —Ä–µ–∂–∏–º**
   - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–∞–Ω–Ω—ã—Ö
   - –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CBC, CTR –∏–ª–∏ GCM

3. **–ù–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å IV**
   - IV –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `SecureRandom`

4. **–ù–µ —Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á–∏ –≤ –∫–æ–¥–µ**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∫–ª—é—á–µ–π
   - –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ key derivation functions

### ‚úÖ –î–ï–õ–ê–¢–¨

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**
   - AES-256 (–¥–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤)
   - ChaCha20 (–¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é**
   - GCM mode (AES-GCM)
   - Poly1305 (ChaCha20-Poly1305)

3. **–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ –∫–ª—é—á–∏ –∏ IV**
   ```java
   SecureRandom random = new SecureRandom();
   byte[] key = new byte[32];  // 256 –±–∏—Ç
   random.nextBytes(key);
   ```

4. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏**
   - –ù–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–∞—Ö –Ω–∞–±–∏–≤–∫–∏
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å constant-time —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

---

# –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

‚úÖ **–ü–æ–ª–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞**:
- –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏—Ç–æ–≤
- 3 —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- –°–µ—Ç—å –§–µ–π—Å—Ç–µ–ª—è
- –ê–ª–≥–æ—Ä–∏—Ç–º DES (16 —Ä–∞—É–Ω–¥–æ–≤)
- –ê–ª–≥–æ—Ä–∏—Ç–º DEAL (6 —Ä–∞—É–Ω–¥–æ–≤)

‚úÖ **7 —Ä–µ–∂–∏–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è**:
- ECB, CBC, PCBC, CFB, OFB, CTR, Random Delta

‚úÖ **4 —Ä–µ–∂–∏–º–∞ –Ω–∞–±–∏–≤–∫–∏**:
- Zeros, ANSI X.923, PKCS7, ISO 10126

‚úÖ **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**:
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å (CompletableFuture)
- –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º (ExecutorService)
- –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
- 36 unit-—Ç–µ—Å—Ç–æ–≤

‚úÖ **–ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**:
- Strategy, Template Method, Adapter, Factory

## –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å

–≠—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:

1. **–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏**:
   - –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –±–ª–æ—á–Ω—ã–µ —à–∏—Ñ—Ä—ã
   - –†–æ–ª—å –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ –∏ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ–∫
   - –í–∞–∂–Ω–æ—Å—Ç—å —Ä–µ–∂–∏–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

2. **–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - –û–û–ü –ø—Ä–∏–Ω—Ü–∏–ø—ã (SOLID)
   - –ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**:
   - –ü–æ—á–µ–º—É DES —É—Å—Ç–∞—Ä–µ–ª
   - –ö–∞–∫ —É—Å–∏–ª–∏—Ç—å —à–∏—Ñ—Ä—ã (DEAL)
   - –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏ –∑–∞—â–∏—Ç—ã

## –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

1. **–ù–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**: AES, 3DES, Blowfish
2. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: HMAC, GCM
3. **Key derivation**: PBKDF2, scrypt
4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, SIMD
5. **Hardware acceleration**: AES-NI

---

# –°–ü–ò–°–û–ö –õ–ò–¢–ï–†–ê–¢–£–†–´

1. **FIPS 46-3**: Data Encryption Standard (DES)
2. **NIST SP 800-38A**: Recommendation for Block Cipher Modes of Operation
3. **Applied Cryptography**, Bruce Schneier
4. **Handbook of Applied Cryptography**, Menezes, van Oorschot, Vanstone
5. **Design Patterns**, Gang of Four
6. **Clean Code**, Robert C. Martin

---

**–ö–æ–Ω–µ—Ü —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞**

_–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ –¥–ª—è –∑–∞—â–∏—Ç—ã –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã ‚Ññ1 –ø–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏_

