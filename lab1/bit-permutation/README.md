# Bit Permutation - Перестановка битов

## Описание

Реализация функции для выполнения перестановки битов в массиве байтов с использованием P-блока (блока перестановок). Реализация основана на Go-библиотеке из репозитория `crypto`.

## Структура проекта

```
bit-permutation/
├── src/                    # Исходный код
│   ├── BitIndexMode.java   # Enum режимов индексации
│   ├── BitPermutation.java # Основная функция перестановки
│   └── Demo.java           # Примеры использования
├── test/                   # Тесты
│   └── BitPermutationTest.java
├── build.sh                # Скрипт компиляции
├── run-demo.sh             # Запуск демонстрации
├── run-tests.sh            # Запуск тестов
└── README.md               # Документация
```

## Быстрый старт

### Компиляция

```bash
./build.sh
```

Или вручную:
```bash
# Компиляция исходников
javac -d out/production src/*.java

# Компиляция тестов
javac -d out/test -cp out/production test/*.java
```

### Запуск тестов

```bash
./run-tests.sh
```

Или:
```bash
java -cp out/test:out/production BitPermutationTest
```

### Запуск демонстрации

```bash
./run-demo.sh
```

Или:
```bash
java -cp out/production Demo
```

## Основная функция

### Сигнатура

```java
public static byte[] permutateBits(
    byte[] data,           // Исходные данные
    int[] pBlock,          // Правило перестановки (массив индексов)
    BitIndexMode indexMode, // Режим индексации битов
    boolean zeroIndexed    // true = индексы с 0, false = индексы с 1
)
```

### Параметры

#### `data` - Массив байтов
Исходные данные для перестановки.

#### `pBlock` - P-блок (массив индексов)
Определяет правило перестановки. Каждый элемент указывает, откуда брать бит:
- `pBlock[i]` - индекс бита в исходных данных, который будет помещён на позицию `i` в результате.

#### `indexMode` - Режим индексации
- **BitIndexMode.NORMAL**: биты индексируются от LSB (младший бит) к MSB (старший бит)
  - Для байта `0b10101010`: бит 0 = 0, бит 1 = 1, ..., бит 7 = 1
- **BitIndexMode.INVERTED**: биты индексируются от MSB к LSB
  - Для байта `0b10101010`: бит 0 = 1, бит 1 = 0, ..., бит 7 = 0

#### `zeroIndexed` - Начальный индекс
- **true**: индексация начинается с 0 (0, 1, 2, 3, ...)
- **false**: индексация начинается с 1 (1, 2, 3, 4, ...)

## Примеры использования

### Пример 1: Простая реверсия байта

```java
byte[] data = {(byte) 0b11001010};
int[] pBlock = {7, 6, 5, 4, 3, 2, 1, 0};

byte[] result = BitPermutation.permutateBits(
    data, pBlock, BitIndexMode.INVERTED, true
);

// Результат: 0b01010011
```

### Пример 2: Обмен двух байтов местами

```java
byte[] data = {(byte) 0b11110000, (byte) 0b00001111};
int[] pBlock = {8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7};

byte[] result = BitPermutation.permutateBits(
    data, pBlock, BitIndexMode.INVERTED, true
);

// Результат: 0b00001111 0b11110000
```

### Пример 3: Индексация с 1

```java
byte[] data = {(byte) 0b10101010};
int[] pBlock = {1, 2, 3, 4, 5, 6, 7, 8}; // Индексы от 1 до 8

byte[] result = BitPermutation.permutateBits(
    data, pBlock, BitIndexMode.INVERTED, false // zeroIndexed = false
);
```

## Обработка ошибок

Функция выбрасывает `IllegalArgumentException` в следующих случаях:
- `data` равен `null` или пуст
- `pBlock` равен `null` или пуст
- Индекс в `pBlock` выходит за границы данных

## Тесты

Набор из 6 тестов покрывает:
1. Реверсия битов (MSB режим)
2. Реверсия битов (LSB режим)
3. Идентичное отображение
4. Перестановка в двух байтах
5. Индексация с 1
6. Обработка ошибок (выход за границы)

## Сложность

- **Время**: O(n), где n - длина P-блока
- **Память**: O(m), где m - количество байтов для хранения результата

## Применение

Эта функция используется в криптографических алгоритмах, таких как:
- DES (Data Encryption Standard)
- Сети Фейстеля
- Другие блочные шифры с перестановками

## Требования

- Java 8 или выше
- Никаких внешних зависимостей

## Автор

Лабораторная работа №1 по криптографии

